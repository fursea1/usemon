#summary How to install Usemon

= Usemon Install Guide=

== Prerequisites ==
  * The collector need a JRE version >= 5.x
  * TCP connectivity to the MySQL database on por 3306 from the machine running the collector
  * UDP Multicast connectivity from each server running the agent to the server running the collector on 224.82.199.166:16200
  * Latest version: usemon-distro-1.0-bin.tar.gz

== Files and their reason for existence ==
The <VERSION> part of the filename will vary depending on the version of Usemon that you are deploying.

=== Static files ===
  * usemon-agent-java-<VERSION>-jar-with-dependencies.jar - The Usemon agent responsible for extracting information from the running applications
  * usemon-agent-preinstrument-java-<VERSION>-jar-with-dependencies.jar - Used to create the code needed to boostrap the agent on Java <=1.4
  * usemon-collector-java-<VERSION>-jar-with-dependencies.jar - Used to receive multicasted data from the agent and deliver them to the Usemon database

=== Generated files ===
  * usemon-bootstrap.jar - Generated by the preinstrument tool for Java <=1.4 deployments

== Step by step ==

=== Variables used in the guide ===
  * $JAVA5_HOME - Java >= 5.x JRE or JDK home directory, eg. /usr/lib/jdk5/jre
  * $USEMON_HOME - Usemon home directory (where the files were unpacked), eg. /opt/usemon
  * (Optionally) $WAS_HOME - WebSphere home directory, eg. /opt/WebSphere/AppServer

=== Do the preinstrumentation (Only Java <=4.2) ===
  * cd $USEMON_HOME
  * Run the usemon-agent-preinstrument-java-<VERSION>-jar-with-dependencies.jar using the app server JRE.
  * Verify that the usemon-boostrap.jar file was created and that the $USEMON_HOME/logs directory was created

=== If you are running your app server with Java security enabled ===
==== Example: Add WAS security permissions ====
Add the following in $WAS_HOME/properties/server.policy
{{{
grant codeBase "file:${was.install.root}/usemon/-" {
  permission java.security.AllPermission;
};
}}}
The snippet assume $USEMON_HOME to be $WAS_HOME/usemon

=== Add the agent definition to the app server java process ===
==== Example: WebSphere 5.1 (Java <=1.4) ====
  * In the WAS admin console to the following steps for each server to be instrumented
  * Navigate to Application Servers > SERVERNAME > Process Definition > Java Virtual Machine
  * Add system properties for the following keys (example values after the dash)
  ** usemon.system.id - eg. MySystem
  ** usemon.cluster.id - eg. MyCluster
  ** usemon.server.id - eg. MyServer
  * Prepend "$USEMON_HOME/usemon-agent-java-<VERSION>-jar-with-dependencies.jar: $USEMON_HOME/usemon-bootstrap.jar" in the Boot Classpath (or in Generic JVM arguments defined by -Xbootclasspath/p)
  * Save and sync the nodes and restart the server
  * When the server starts verify that the file usemon.log is either written to $USEMON_HOMR/logs or $WAS_HOME/logs
